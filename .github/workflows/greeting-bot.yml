name: Greeting Bot

on:
  issues:
    types: [opened]
  pull_request:
    types: [opened]

jobs:
  greet:
    runs-on: ubuntu-latest
    steps:
      - name: Check out the code
        uses: actions/checkout@v3  # Updated version

      - name: Set up Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '20'  # Specify the version you want to use

      - name: Greet User
        uses: actions/github-script@v6
        with:
          script: |
            const issue = context.payload.issue || context.payload.pull_request;

            // Check if issue or pull request exists
            if (!issue) {
              console.error("No issue or pull request context available.");
              return; // Exit early if there's no issue or PR context
            }

            const user = issue.user.login;
            const emoji = 'ðŸ˜Š';
            const title = issue.title || "No Title"; // Handle case where title might be undefined
            const isIssue = context.payload.issue !== undefined; // Check if it's an issue
            const message = isIssue
              ? `ðŸ‘‹ Hello @${user} ${emoji}!\n\nThank you for opening this issue titled "${title}"! We're excited to see your contribution! ðŸš€\n\n**Before we proceed, please keep the following rules in mind:**\n1. **Be respectful**: Treat everyone with kindness and respect.\n2. **Follow the contribution guidelines**: Ensure your code adheres to our [contribution guidelines](link-to-guidelines).\n3. **Open relevant issues**: Make sure your issue is relevant to the project.\n4. **Ask for help**: If you have any questions, don't hesitate to ask!\n\nIf you have any other suggestions or improvements, feel free to share them with us! ðŸ˜Š\n\nHappy coding! ðŸŽˆ`
              : `ðŸ‘‹ Hello @${user} ${emoji}!\n\nThank you for creating this pull request titled "${title}"! We're excited to see your contribution! ðŸš€\n\n**Before we proceed, please keep the following rules in mind:**\n1. **Be respectful**: Treat everyone with kindness and respect.\n2. **Follow the contribution guidelines**: Ensure your code adheres to our [contribution guidelines](link-to-guidelines).\n3. **Open relevant issues**: Make sure your issue is relevant to the project.\n4. **Ask for help**: If you have any questions, don't hesitate to ask!\n\nIf you have any other suggestions or improvements, feel free to share them with us! ðŸ˜Š\n\nHappy coding! ðŸŽˆ`;

            await github.issues.createComment({
              ...context.repo,
              issue_number: issue.number,
              body: message
            });

